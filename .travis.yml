language: java

jdk:
  - openjdk8

script:
  - mvn test -B
  - mvn org.pitest:pitest-maven:mutationCoverage

before_deploy:
  - POM_VERSION=$(mvn -q -Dexec.executable=echo -Dexec.args='${project.version}' --non-recursive exec:exec)

# Releases config copied from https://docs.travis-ci.com/user/deployment/releases/ and secure key generated by following
# https://stackoverflow.com/questions/25302518/travis-ci-setup-releases-with-github-token#answer-57032190
deploy:
  provider: releases
  api_key:
    secure: tNrgQeaH6gn+JH2IV7DqJ3oaGgQYMvku8mAmuKZMqg/TLkWbopeaaO9SK83SOOqnj9QL25rSan/THFBtofa8nd3SACGP0+eAzhNRyRHZ7HET/Na2BPS2uhcDMsKSv27dv16BXqRDSs/rAh76CKg54KlU5Oik/zoET78/KMawuREpgojT41znCrFfNNvYEo6wmkBxE2P3g4Wdrd8nmcHGkyHbIV0NQOcE0myhbR0wAzqoydavCiWBwSE1m1GjDaejJaq1Od/HL4WrjCkBptx4qldOZG866lFA037CHUAkBWu8Rs8n8AlMgY22gykzQwriX+Xy8+/f05/Oj+ldoAr8IewzmM1JohwHmJpnaq5TLzfLYIOxjEhne2SvUMcXIHPYtWQ3bvvsXBxPnWdiXz0HWgNF2gC2dJrBlaarfI+Vcw1mCsir0fJFWUIStvLHIlSnK5DNbU5MQ1kJrHP01YwOTLTVYxFNWgxT+9eGUMrvPgyskflya5iRTJdkNWde3czl4XdEQ+XxuYs8v6EBliMYD3nqf6/K/37E1AUOh//QXFtZCna8Rkbfhuc/PWAA8Us7XtAZDkTAh8YF2LrYh9pw7U0wxunD1zLCpB4lq8KjqaAP81lRXEfjq/IvjpU0Qw+JLSH54JO9yuxqq6kyCCWbzt3s5weP3Vl7IY4Oaobriv4=
  file:
    - "spt-development-logging-spring-boot-autoconfigure/target/spt-development-logging-spring-boot-autoconfigure-${POM_VERSION}.jar"
    - "spt-development-logging-spring-boot-starter/target/spt-development-logging-spring-boot-starter-${POM_VERSION}.jar"
  skip_cleanup: true
  on:
    tags: true
