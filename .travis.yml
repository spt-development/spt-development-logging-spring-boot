language: java

jdk:
  - openjdk8

script:
  - mvn test -B
  - mvn org.pitest:pitest-maven:mutationCoverage

before_deploy:
  - POM_VERSION=$(mvn -q -Dexec.executable=echo -Dexec.args='${project.version}' --non-recursive exec:exec)

# Releases config copied from https://docs.travis-ci.com/user/deployment/releases/ and secure key generated by following
# https://stackoverflow.com/questions/25302518/travis-ci-setup-releases-with-github-token#answer-57032190
deploy:
  provider: releases
  api_key:
    secure: DV3NL+lLQd/QZaDCr5qTJphiP7TLwTz8fozEP42Ub555dhsf0yTMxleWuOTVpuGMnvWiwO9T0E7QKYh+nIOmaIWLCE8KGw3PwFkhvg9PzYZn0XqrySzqAj1MZy3HpnNaiGyoRywae72AUwQ+t+fvL41TcHcREUGX/106+NXnOzXRDOFXOtPb3krQ8Ut1EN9iIRM9qc7dkKr8tF++SgQaTpitgvuA1ng7QAUv+L9PyKyEjdVGCEXDaaxSIvH7wV4/9Ouy/wgSDLxF6EK4Wg4jk11dqw/yg4k9OEl1iqobQPoTP9XHjN0a0nnISROi/qUrdCfBKxko87pJ+usi4tRPbgNVBdL65FGoucglYPyaWS7IRxtX2jiGYFMHpF8q2SyVjXjukkIEHoUh6rNRfn+NUIhVBuzmQDYqBIgcJTQ1BmdmarPsPHeAnGzO3aEZOHkfJppLsDwRJxdqdsbUu0m3vC7jFPZdIUNZ2r1mboGBxqaQegqZwj7ChiK55sZ7SL3NFOZRiO9dQY93yqiiW4/p/JBO04b+aOBDQoPcmLSSxrKaqeskvYUkQew39PeBddT2CYZJVVODWAavKK1YZrekshiFs/PWmvCo6j6OuP7PPhbVMWTucAejPwRv26Paa41hLEUVQMAh6XW6RBlABCxfDKwJ4aYWvleHiI7rY+9skoE=
  file:
    - "spt-development-logging-spring-boot-autoconfigure/target/spt-development-logging-spring-boot-autoconfigure-${POM_VERSION}.jar"
    - "spt-development-logging-spring-boot-starter/target/spt-development-logging-spring-boot-starter-${POM_VERSION}.jar"
  skip_cleanup: true
  on:
    tags: true
